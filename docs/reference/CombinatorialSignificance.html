<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute the Statistical Significance of Each Replicate Combination — CombinatorialSignificance • myTAI</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute the Statistical Significance of Each Replicate Combination — CombinatorialSignificance"><meta property="og:description" content="In case a PhyloExpressionSet or DivergenceExpressionSet stores replicates for each
developmental stage or experiment, this function allows to compute the p-values quantifying
the statistical significance of the underlying pattern for all combinations of replicates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">myTAI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Advanced.html">Advanced Phylotranscriptomics Analyses</a>
    </li>
    <li>
      <a href="../articles/Enrichment.html">Enrichment Analyses</a>
    </li>
    <li>
      <a href="../articles/Expression.html">Gene Expression Analysis with `myTAI`</a>
    </li>
    <li>
      <a href="../articles/Intermediate.html">Intermediate Phylotranscriptomics Analyses</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction to the myTAI package</a>
    </li>
    <li>
      <a href="../articles/Phylostratigraphy.html">Discussing Genomic Phylostratigraphy</a>
    </li>
    <li>
      <a href="../articles/Taxonomy.html">Retrieving Taxonomic Information</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/drostlab/myTAI/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute the Statistical Significance of Each Replicate Combination</h1>
    <small class="dont-index">Source: <a href="https://github.com/drostlab/myTAI/blob/HEAD/R/combinatorialSignificance.R" class="external-link"><code>R/combinatorialSignificance.R</code></a></small>
    <div class="hidden name"><code>CombinatorialSignificance.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>In case a PhyloExpressionSet or DivergenceExpressionSet stores replicates for each
developmental stage or experiment, this function allows to compute the p-values quantifying
the statistical significance of the underlying pattern for all combinations of replicates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CombinatorialSignificance</span><span class="op">(</span></span>
<span>  <span class="va">ExpressionSet</span>,</span>
<span>  <span class="va">replicates</span>,</span>
<span>  TestStatistic <span class="op">=</span> <span class="st">"FlatLineTest"</span>,</span>
<span>  permutations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ExpressionSet</dt>
<dd><p>a standard PhyloExpressionSet or DivergenceExpressionSet object.</p></dd>


<dt>replicates</dt>
<dd><p>a numeric vector storing the number of replicates within each developmental stage or experiment.
In case replicate stores only one value, then the function assumes that each developmental stage or experiment
stores the same number of replicates.</p></dd>


<dt>TestStatistic</dt>
<dd><p>a string defining the type of test statistics to be used to quantify the statistical significance the present phylotranscriptomics pattern.
Default is <code>TestStatistic</code> = <code>"FlatLineTest"</code>.</p></dd>


<dt>permutations</dt>
<dd><p>a numeric value specifying the number of permutations to be performed for the <code><a href="FlatLineTest.html">FlatLineTest</a></code>.</p></dd>


<dt>parallel</dt>
<dd><p>a boolean value specifying whether parallel processing (multicore processing) shall be performed.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a numeric vector storing the p-values returned by the underlying test statistic for all possible replicate combinations.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The intention of this analysis is to validate that there exists no sequence of replicates 
(for all possible combination of replicates) that results in a non-significant pattern,
when the initial pattern with combined replicates was shown to be significant.</p>
<p>A small Example:</p>
     
<p>Assume PhyloExpressionSet stores 3 developmental stages with 3 replicates measured for each stage.
The 9 replicates in total are denoted as: 1.1, 1.2, 1.3, 2.1, 2.2, 2.3, 3.1, 3.2, 3.3. Now the function computes the
statistical significance of each pattern derived by the corresponding combination of replicates, e.g.</p>
<ul><li><p>1.1, 2.1, 3.1 -&gt; p-value for combination 1</p></li>
<li><p>1.1, 2.2, 3.1  -&gt; p-value for combination 2</p></li>
<li><p>1.1, 2.3, 3.1 -&gt; p-value for combination 3</p></li>
<li><p>1.2, 2.1, 3.1 -&gt; p-value for combination 4</p></li>
<li><p>1.2, 2.1, 3.1 -&gt; p-value for combination 5</p></li>
<li><p>1.2, 2.1, 3.1 -&gt; p-value for combination 6</p></li>
<li><p>1.3, 2.1, 3.1 -&gt; p-value for combination 7</p></li>
<li><p>1.3, 2.2, 3.1 -&gt; p-value for combination 8</p></li>
<li><p>1.3, 2.3, 3.1 -&gt; p-value for combination 9</p></li>
</ul><p>This procedure yields 27 p-values for the \(3^3\) (\(n_stages^n_replicates\)) replicate combinations.</p>
<p>Note, that in case you have a large amount of stages/experiments and a large amount of replicates
the computation time will increase by \(n_stages^n_replicates\). For 11 stages and 4 replicates, 4^11 = 4194304 p-values have to be computed. 
Each p-value computation itself is based on a permutation test running with 1000 or more permutations. Be aware that this might take some time.</p>
<p>The p-value vector returned by this function can then be used to plot the p-values to see
whether an critical value \(\alpha\) is exeeded or not (e.g. \(\alpha = 0.05\)).</p>

<p>The function receives a standard PhyloExpressionSet or DivergenceExpressionSet object and a vector storing the number of replicates present in each stage or experiment. Based on these arguments the function computes all possible replicate combinations using the <code><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></code> function and performs a permutation test (either a <code><a href="FlatLineTest.html">FlatLineTest</a></code> for each replicate combination. The <em>permutation</em> parameter of this function specifies the number of permutations that shall be performed for each permutation test. When all p-values are computed, a numeric vector storing the corresponding p-values for each replicate combination is returned.</p>
<p>In other words, for each replicate combination present in the PhyloExpressionSet or DivergenceExpressionSet object, the TAI or TDI pattern of the corresponding replicate combination is tested for its statistical significance based on the underlying test statistic.</p>
<p>This function is also able to perform all computations in parallel using multicore processing. The underlying statistical tests are written in C++ and optimized for fast computations.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Drost HG et al. (2015) Mol Biol Evol. 32 (5): 1221-1231 doi:10.1093/molbev/msv012</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></code>, <code><a href="FlatLineTest.html">FlatLineTest</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Hajk-Georg Drost</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load a standard PhyloExpressionSet</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PhyloExpressionSetExample</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we assume that the PhyloExpressionSetExample </span></span></span>
<span class="r-in"><span><span class="co"># consists of 3 developmental stages </span></span></span>
<span class="r-in"><span><span class="co"># and 2 replicates for stage 1, 3 replicates for stage 2, </span></span></span>
<span class="r-in"><span><span class="co"># and 2 replicates for stage 3</span></span></span>
<span class="r-in"><span><span class="co"># FOR REAL ANALYSES PLEASE USE: permutations = 1000 or 10000</span></span></span>
<span class="r-in"><span><span class="co"># BUT NOTE THAT THIS TAKES MUCH MORE COMPUTATION TIME</span></span></span>
<span class="r-in"><span><span class="va">p.vector</span> <span class="op">&lt;-</span> <span class="fu">CombinatorialSignificance</span><span class="op">(</span>ExpressionSet <span class="op">=</span> <span class="va">PhyloExpressionSetExample</span>, </span></span>
<span class="r-in"><span>                                      replicates    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                                      TestStatistic <span class="op">=</span> <span class="st">"FlatLineTest"</span>, </span></span>
<span class="r-in"><span>                                      permutations  <span class="op">=</span> <span class="fl">10</span>, </span></span>
<span class="r-in"><span>                                      parallel      <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> We recommended using at least 20000 permutations to achieve a sufficient permutation test.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> We recommended using at least 20000 permutations to achieve a sufficient permutation test.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> We recommended using at least 20000 permutations to achieve a sufficient permutation test.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> We recommended using at least 20000 permutations to achieve a sufficient permutation test.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> We recommended using at least 20000 permutations to achieve a sufficient permutation test.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> We recommended using at least 20000 permutations to achieve a sufficient permutation test.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> We recommended using at least 20000 permutations to achieve a sufficient permutation test.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> We recommended using at least 20000 permutations to achieve a sufficient permutation test.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> We recommended using at least 20000 permutations to achieve a sufficient permutation test.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> We recommended using at least 20000 permutations to achieve a sufficient permutation test.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> We recommended using at least 20000 permutations to achieve a sufficient permutation test.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> We recommended using at least 20000 permutations to achieve a sufficient permutation test.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Hajk-Georg Drost, Kristian K Ullrich, Jaruwatana Sodai Lotharukpong, Nikola Kalábová.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

