<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot the Expression Levels of each Age or Divergence Category as Boxplot, Violinplot, or Dotplot — PlotCategoryExpr • myTAI</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot the Expression Levels of each Age or Divergence Category as Boxplot, Violinplot, or Dotplot — PlotCategoryExpr"><meta name="description" content="This function visualizes the expression level distribution of each phylostratum during each time point or experiment
as boxplot, dot plot, or violin plot enabling users to quantify the age (PS) or divergence (DS) category specific contribution to the
corresponding transcriptome."><meta property="og:description" content="This function visualizes the expression level distribution of each phylostratum during each time point or experiment
as boxplot, dot plot, or violin plot enabling users to quantify the age (PS) or divergence (DS) category specific contribution to the
corresponding transcriptome."><meta property="og:image" content="https://drostlab.github.io/myTAI/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">myTAI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Advanced.html">Advanced Phylotranscriptomics Analyses</a></li>
    <li><a class="dropdown-item" href="../articles/Enrichment.html">Enrichment Analyses</a></li>
    <li><a class="dropdown-item" href="../articles/Expression.html">Gene Expression Analysis with `myTAI`</a></li>
    <li><a class="dropdown-item" href="../articles/Intermediate.html">Intermediate Phylotranscriptomics Analyses</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction to the myTAI package</a></li>
    <li><a class="dropdown-item" href="../articles/Phylostratigraphy.html">Discussing Genomic Phylostratigraphy</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/drostlab/myTAI/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot the Expression Levels of each Age or Divergence Category as Boxplot, Violinplot, or Dotplot</h1>
      <small class="dont-index">Source: <a href="https://github.com/drostlab/myTAI/blob/HEAD/R/PlotCategoryExpr.R" class="external-link"><code>R/PlotCategoryExpr.R</code></a></small>
      <div class="d-none name"><code>PlotCategoryExpr.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function visualizes the expression level distribution of each phylostratum during each time point or experiment
as boxplot, dot plot, or violin plot enabling users to quantify the age (PS) or divergence (DS) category specific contribution to the
corresponding transcriptome.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PlotCategoryExpr</span><span class="op">(</span></span>
<span>  <span class="va">ExpressionSet</span>,</span>
<span>  <span class="va">legendName</span>,</span>
<span>  test.stat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"category-centered"</span>,</span>
<span>  distr.type <span class="op">=</span> <span class="st">"boxplot"</span>,</span>
<span>  y.ticks <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  log.expr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  gene.set <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-expressionset">ExpressionSet<a class="anchor" aria-label="anchor" href="#arg-expressionset"></a></dt>
<dd><p>a standard PhyloExpressionSet or DivergenceExpressionSet object.</p></dd>


<dt id="arg-legendname">legendName<a class="anchor" aria-label="anchor" href="#arg-legendname"></a></dt>
<dd><p>a character string specifying whether "PS" or "DS" are used to compute relative expression profiles.</p></dd>


<dt id="arg-test-stat">test.stat<a class="anchor" aria-label="anchor" href="#arg-test-stat"></a></dt>
<dd><p>a logical value indicating whether a Benjamini-Hochberg adjusted <code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test</a></code> should be applied to determine
significant differences in age or divergence category specific expression.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>type of age or divergence category comparison. Specifications can be <code>type = "category-centered"</code> or <code>type = "stage-centered"</code>.</p></dd>


<dt id="arg-distr-type">distr.type<a class="anchor" aria-label="anchor" href="#arg-distr-type"></a></dt>
<dd><p>format of visualizing age or divergence category specific expression distributions. Either <code>distr.type = "boxplot"</code>, <code>distr.type = "dotplot"</code>, or
<code>distr.type = "violin"</code>.</p></dd>


<dt id="arg-y-ticks">y.ticks<a class="anchor" aria-label="anchor" href="#arg-y-ticks"></a></dt>
<dd><p>number of y-axis ticks (default <code>y.ticks = 10</code>).</p></dd>


<dt id="arg-log-expr">log.expr<a class="anchor" aria-label="anchor" href="#arg-log-expr"></a></dt>
<dd><p>a logical value specifying whether or not expression levels should internally be log2-transformed before visualization.</p></dd>


<dt id="arg-gene-set">gene.set<a class="anchor" aria-label="anchor" href="#arg-gene-set"></a></dt>
<dd><p>a character vector storing the gene ids for which gene expression levels shall be visualized.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A boxplot, violin plot, or dot plot visualizing the gene expression levels of
different PS or DS categories.</p>
<p>Furthermore, the statistical test results returned from the <code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test</a></code> are printed
to the console.</p>
<p>(1) '*'   = P-Value &lt;= 0.05</p>
<p>(2) '**'  = P-Value &lt;= 0.005</p>
<p>(3) '***' = P-Value &lt;= 0.0005</p>
<p>(4) 'n.s.' = not significant = P-Value &gt; 0.05</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This way of visualizing the gene expression distribution of each age (PS) or divergence (DS) category during
all developmental stages or experiments allows users to detect specific age or divergence categories contributing significant
levels of gene expression to the underlying biological process (transcriptome).</p>
<p>This quantification allows users to conclude that genes originating in specific PS or DS contribute significantly more to the overall transcriptome
than other genes originating from different PS or DS categories. More specialized analyses such as <code><a href="PlotMeans.html">PlotMeans</a></code>, <code><a href="PlotRE.html">PlotRE</a></code>,
<code><a href="PlotBarRE.html">PlotBarRE</a></code>, etc. will then allow to study the exact mean expression patterns of these age or divergence categories.</p>
<p>The statistical quantification of differences between expression levels of different age or divergence categories
is done by performing a <code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test</a></code> with Benjamini &amp; Hochberg p-value adjustment for multiple comparisons.</p>
<ul><li><p><code>type = "category-centered"</code> Here, the <code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test</a></code> quantifies the differences of gene expression between all combinations of age or divergence categories for each stage or experiment separately. Here, a significant p-value quantifies that there is at least one pairwise comparison for which age or divergence categories significantly differ in their gene expression distribution. This type of analysis allows users to detect stages or experiments that show high diviation between age or divergence category contributions to the overall transcriptome or no significant deviations of age or divergence categories, suggesting equal age or divergence category contributions to the overall transcriptome.</p></li>
<li><p><code>type = "stage-centered"</code> Here, the <code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test</a></code> quantifies the differences of gene expression between all stages or experiments for each age or divergence category separately. Hence, the test quantifies whether or not the gene expression distribution of a single age or divergence category significantly changes throughout development or experiments. This type of analysis allows users to detect specific age or divergence categories that significantly change their expression levels throughout development or experiments.</p></li>
</ul><p>Argument Specifications:</p>
<p>Argument: type</p>
<ul><li><p><code>type = "category-centered"</code> This specification allows users to compare the differences between all age or
 divergence categories during the same stage or experiment.</p></li>
<li><p><code>type = "stage-centered"</code> This specification allows users to compare the differences between all age or
 divergence categories between stages or experiments.</p></li>
</ul><p>Argument: distr.type</p>
<ul><li><p><code>distr.type = "boxplot"</code> This specification allows users to visualize the expression distribution of all PS or DS as boxplot.</p></li>
<li><p><code>distr.type = "violin"</code> This specification allows users to visualize the expression distribution of all PS or DS as violin plot.</p></li>
<li><p><code>distr.type = "dotplot"</code> This specification allows users to visualize the expression distribution of all PS or DS as dot plot.</p></li>
</ul><p>Finally, users can specify a <code>gene.set</code> (a subset of genes included in the input <code>ExpressioSet</code>)
for which expression levels should be visualized as boxplot, dotplot, or violinplot.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="PlotMeans.html">PlotMeans</a></code>, <code><a href="PlotRE.html">PlotRE</a></code>, <code><a href="PlotBarRE.html">PlotBarRE</a></code>, <code><a href="age.apply.html">age.apply</a></code>,
<code><a href="pTAI.html">pTAI</a></code>, <code><a href="pTDI.html">pTDI</a></code>, <code><a href="pStrata.html">pStrata</a></code>, <code><a href="pMatrix.html">pMatrix</a></code>, <code><a href="TAI.html">TAI</a></code>, <code><a href="TDI.html">TDI</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Hajk-Georg Drost</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PhyloExpressionSetExample</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DivergenceExpressionSetExample</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># category-centered visualization of PS specific expression level distributions (log-scale)</span></span></span>
<span class="r-in"><span><span class="fu">PlotCategoryExpr</span><span class="op">(</span>ExpressionSet <span class="op">=</span> <span class="va">PhyloExpressionSetExample</span>,</span></span>
<span class="r-in"><span>                     legendName    <span class="op">=</span> <span class="st">"PS"</span>,</span></span>
<span class="r-in"><span>                     test.stat     <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                     type          <span class="op">=</span> <span class="st">"category-centered"</span>,</span></span>
<span class="r-in"><span>                     distr.type    <span class="op">=</span> <span class="st">"boxplot"</span>,</span></span>
<span class="r-in"><span>                     log.expr      <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>                     </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># stage-centered visualization of PS specific expression level distributions (log-scale)</span></span></span>
<span class="r-in"><span><span class="fu">PlotCategoryExpr</span><span class="op">(</span>ExpressionSet <span class="op">=</span> <span class="va">PhyloExpressionSetExample</span>,</span></span>
<span class="r-in"><span>                     legendName    <span class="op">=</span> <span class="st">"PS"</span>,</span></span>
<span class="r-in"><span>                     test.stat     <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                     distr.type    <span class="op">=</span> <span class="st">"boxplot"</span>,</span></span>
<span class="r-in"><span>                     type          <span class="op">=</span> <span class="st">"stage-centered"</span>,</span></span>
<span class="r-in"><span>                     log.expr      <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>                     </span></span>
<span class="r-in"><span>                                                               </span></span>
<span class="r-in"><span><span class="co"># category-centered visualization of PS specific expression level distributions (log-scale)</span></span></span>
<span class="r-in"><span><span class="co"># as violoin plot</span></span></span>
<span class="r-in"><span><span class="fu">PlotCategoryExpr</span><span class="op">(</span>ExpressionSet <span class="op">=</span> <span class="va">PhyloExpressionSetExample</span>,</span></span>
<span class="r-in"><span>                     legendName    <span class="op">=</span> <span class="st">"PS"</span>,</span></span>
<span class="r-in"><span>                     test.stat     <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                     distr.type    <span class="op">=</span> <span class="st">"violin"</span>,</span></span>
<span class="r-in"><span>                     type          <span class="op">=</span> <span class="st">"stage-centered"</span>,</span></span>
<span class="r-in"><span>                     log.expr      <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># analogous for DivergenceExpressionSets</span></span></span>
<span class="r-in"><span><span class="fu">PlotCategoryExpr</span><span class="op">(</span>ExpressionSet <span class="op">=</span> <span class="va">DivergenceExpressionSetExample</span>,</span></span>
<span class="r-in"><span>                     legendName    <span class="op">=</span> <span class="st">"DS"</span>,</span></span>
<span class="r-in"><span>                     test.stat     <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                     type          <span class="op">=</span> <span class="st">"category-centered"</span>,</span></span>
<span class="r-in"><span>                     distr.type    <span class="op">=</span> <span class="st">"boxplot"</span>,</span></span>
<span class="r-in"><span>                     log.expr      <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># visualize the expression levels of 500 example genes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">example.gene.set</span> <span class="op">&lt;-</span> <span class="va">PhyloExpressionSetExample</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25260</span>,<span class="fl">500</span><span class="op">)</span> , <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">PlotCategoryExpr</span><span class="op">(</span>ExpressionSet <span class="op">=</span> <span class="va">PhyloExpressionSetExample</span>,</span></span>
<span class="r-in"><span>                 legendName    <span class="op">=</span> <span class="st">"PS"</span>,</span></span>
<span class="r-in"><span>                 test.stat     <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                 type          <span class="op">=</span> <span class="st">"category-centered"</span>,</span></span>
<span class="r-in"><span>                 distr.type    <span class="op">=</span> <span class="st">"boxplot"</span>,</span></span>
<span class="r-in"><span>                 log.expr      <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                 gene.set      <span class="op">=</span> <span class="va">example.gene.set</span><span class="op">)</span></span></span>
<span class="r-in"><span>                 </span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hajk-Georg Drost, Jaruwatana Sodai Lotharukpong, Nikola Kalábová, Filipa Martins Costa, Kristian K Ullrich, Stefan Manolache.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

