<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform Flat Line Test — FlatLineTest • myTAI</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform Flat Line Test — FlatLineTest" />
<meta property="og:description" content="This function quantifies the statistical significance of an observed phylotranscriptomic pattern. In detail, the Flat Line Test quantifies any significant deviation of an observed phylotranscriptomic pattern from a flat line." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">myTAI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Advanced.html">Advanced Phylotranscriptomics Analyses</a>
    </li>
    <li>
      <a href="../articles/Enrichment.html">Enrichment Analyses</a>
    </li>
    <li>
      <a href="../articles/Expression.html">Gene Expression Analysis with `myTAI`</a>
    </li>
    <li>
      <a href="../articles/Intermediate.html">Intermediate Phylotranscriptomics Analyses</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction to the myTAI package</a>
    </li>
    <li>
      <a href="../articles/Phylostratigraphy.html">Discussing Genomic Phylostratigraphy</a>
    </li>
    <li>
      <a href="../articles/Taxonomy.html">Retrieving Taxonomic Information</a>
    </li>
    <li>
      <a href="../articles/scRNAseq.html">Sincgle-Cell Expression Analysis with `myTAI`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/drostlab/myTAI/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform Flat Line Test</h1>
    <small class="dont-index">Source: <a href='https://github.com/drostlab/myTAI/blob/master/R/FlatLineTest.R'><code>R/FlatLineTest.R</code></a></small>
    <div class="hidden name"><code>FlatLineTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function quantifies the statistical significance of an observed phylotranscriptomic pattern. In detail, the <em>Flat Line Test</em> quantifies any significant deviation of an observed phylotranscriptomic pattern from a flat line.</p>
    </div>

    <pre class="usage"><span class='fu'>FlatLineTest</span><span class='op'>(</span>
  <span class='va'>ExpressionSet</span>,
  permutations <span class='op'>=</span> <span class='fl'>1000</span>,
  plotHistogram <span class='op'>=</span> <span class='cn'>FALSE</span>,
  runs <span class='op'>=</span> <span class='fl'>10</span>,
  parallel <span class='op'>=</span> <span class='cn'>FALSE</span>,
  custom.perm.matrix <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ExpressionSet</th>
      <td><p>a standard PhyloExpressionSet or DivergenceExpressionSet object.</p></td>
    </tr>
    <tr>
      <th>permutations</th>
      <td><p>a numeric value specifying the number of permutations that shall be performed for the <em>FlatLineTest</em>.</p></td>
    </tr>
    <tr>
      <th>plotHistogram</th>
      <td><p>a logical value indicating whether a detailed statistical analysis concerning the goodness of fit should be performed.</p></td>
    </tr>
    <tr>
      <th>runs</th>
      <td><p>specify the number of runs to be performed for goodness of fit computations. In most cases runs = 100 is a reasonable choice.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>performing <code>runs</code> in parallel (takes all cores of your multicore machine).</p></td>
    </tr>
    <tr>
      <th>custom.perm.matrix</th>
      <td><p>a custom <code><a href='bootMatrix.html'>bootMatrix</a></code> (permutation matrix) to perform the underlying test statistic. Default is <code>custom.perm.matrix = NULL</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list object containing the list elements:</p><ul>
<li><p><code>p.value</code> the p-value quantifying the statistical significance (deviation from a flat line) of the given phylotranscriptomics pattern.</p></li>
<li><p><code>std.dev</code> the standard deviation of the N sampled phylotranscriptomics patterns for each developmental stage S.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Internally the function performs N phylotranscriptomics pattern computations (<code><a href='TAI.html'>TAI</a></code> or <code><a href='TDI.html'>TDI</a></code>) based on sampled PhyloExpressionSets or DivergenceExpressionSets (see <code><a href='bootMatrix.html'>bootMatrix</a></code>). 
The test statistics is being developed as follows:</p>
<p>The variance <em>V_pattern</em> of the S phylotranscriptomics values defines the test statistic for the <code>FlatLineTest</code>. 
The basic assumption is, that the variance of a flat line should be equivalent to zero for a perfect flat line. 
Any deviation from a flat line can be measured with a variance value &gt; 0.</p>
<p>To determine the null distribution of <em>V_p</em>, all PS or DS values within each developmental stage s are randomly permuted,
 S surrogate phylotranscriptomics values are computed from this permuted dataset, and a surrogate value of <em>V_p</em> is
  computed from these S phylotranscriptomics values. This permutation process is repeated N times, yielding a histogram of <em>V_p</em>.</p>
<p>After applying a <em>Lilliefors Kolmogorov-Smirnov Test for gamma distribution</em>, <em>V_p</em> is approximated by a <em>gamma distribution</em>. 
The two parameters of the <em>gamma distribution</em> are estimated by the function <code><a href='https://rdrr.io/pkg/fitdistrplus/man/fitdist.html'>fitdist</a></code> from the <span class="pkg">fitdistrplus</span> package by <em>moment matching estimation</em>. 
The fitted <em>gamma distribution</em> is considered the null distribution of <em>V_pattern</em>, and the p-value of the observed value of <em>V_p</em> 
is computed from this null distribution.</p>
<p>In case the parameter <em>plotHistogram = TRUE</em>, a multi-plot is generated showing:</p>       
<p>(1) A Cullen and Frey skewness-kurtosis plot generated by <code><a href='https://rdrr.io/pkg/fitdistrplus/man/descdist.html'>descdist</a></code>).</p>
<p>(2) A histogram of V_p combined with the density plot using the Method of Moments estimated parameters returned by the <code><a href='https://rdrr.io/pkg/fitdistrplus/man/fitdist.html'>fitdist</a></code> function using a gamma distribution.</p>
<p>(3) A plot showing the p-values for N independent runs to verify that a specific p-value is biased by a specific permutation order.</p>
<p>The <em>goodness of fit</em> for the random vector <em>V_p</em> is quantified statistically by an adapted Lilliefors (Kolmogorov-Smirnov) test for gamma distributions.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>In case there are extreme outlier expression values stored in the dataset (PhyloExpressionSet or DivergenceExpressionSet),
 the internal <code><a href='https://rdrr.io/pkg/fitdistrplus/man/fitdist.html'>fitdist</a></code> function that is based on the <code><a href='bootMatrix.html'>bootMatrix</a></code> output might return a warning:
  "In densfun(x, parm[1], parm[2], ...) : NaNs were produced" which indicates that permutation results caused by extreme outlier expression values 
  that could not be fitted accordingly. This warning will not be printed out when the corresponding outlier values are extracted from the dataset.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Drost HG et al. (2015) Mol Biol Evol. 32 (5): 1221-1231 doi:10.1093/molbev/msv012</p>
<p>Quint M et al. (2012). A transcriptomic hourglass in plant embryogenesis. Nature (490): 98-101.</p>
<p>M. L. Delignette-Muller, R. Pouillot, J.-B. Denis and C. Dutang (2014), fitdistrplus: help to fit of a parametric distribution to non-censored or censored data.</p>
<p>Cullen AC and Frey HC (1999) Probabilistic techniques in exposure assessment. Plenum Press, USA, pp. 81-159.</p>
<p>Evans M, Hastings N and Peacock B (2000) Statistical distributions. John Wiley and Sons Inc.</p>
<p>Sokal RR and Rohlf FJ (1995) Biometry. W.H. Freeman and Company, USA, pp. 111-115.</p>
<p>Juergen Gross and bug fixes by Uwe Ligges (2012). nortest: Tests for Normality. R package version 1.0-2.</p>
<p>http://CRAN.R-project.org/package=nortest</p>
<p>Dallal, G.E. and Wilkinson, L. (1986): An analytic approximation to the distribution of Lilliefors test for normality. The American Statistician, 40, 294-296.</p>
<p>Stephens, M.A. (1974): EDF statistics for goodness of fit and some comparisons. Journal of the American Statistical Association, 69, 730-737.</p>
<p>http://stackoverflow.com/questions/4290081/fitting-data-to-distributions?rq=1</p>
<p>http://stats.stackexchange.com/questions/45033/can-i-use-kolmogorov-smirnov-test-and-estimate-distribution-parameters</p>
<p>http://cran.r-project.org/doc/contrib/Ricci-distributions-en.pdf</p>
<p>http://cran.r-project.org/doc/contrib/Ricci-distributions-en.pdf</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='TAI.html'>TAI</a></code>, <code><a href='TDI.html'>TDI</a></code>, <code><a href='PlotPattern.html'>PlotPattern</a></code>, <code><a href='bootMatrix.html'>bootMatrix</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Hajk-Georg Drost</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'></span>
<span class='r-in'><span class='co'># read standard phylotranscriptomics data</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>PhyloExpressionSetExample</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># example PhyloExpressionSet using 1000 permutations</span></span>
<span class='r-in'><span class='fu'>FlatLineTest</span><span class='op'>(</span><span class='va'>PhyloExpressionSetExample</span>, </span>
<span class='r-in'>             permutations  <span class='op'>=</span> <span class='fl'>1000</span>, </span>
<span class='r-in'>             plotHistogram <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $p.value</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 1.149108e-10</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $std.dev</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 0.05435870 0.05397902 0.05287674 0.05161667 0.05002024 0.05078462 0.05514320</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># use your own permutation matrix based on which p-values (FlatLineTest)</span></span>
<span class='r-in'><span class='co'># shall be computed</span></span>
<span class='r-in'><span class='va'>custom_perm_matrix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='bootMatrix.html'>bootMatrix</a></span><span class='op'>(</span><span class='va'>PhyloExpressionSetExample</span>,<span class='fl'>100</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'>FlatLineTest</span><span class='op'>(</span><span class='va'>PhyloExpressionSetExample</span>,</span>
<span class='r-in'>             custom.perm.matrix <span class='op'>=</span> <span class='va'>custom_perm_matrix</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $p.value</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [1] 4.398572e-15</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $std.dev</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>     Zygote   Quadrant   Globular      Heart    Torpedo       Bent     Mature </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 0.05767655 0.05655764 0.05540385 0.05411558 0.05380763 0.05307761 0.05320929 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Hajk-Georg Drost, Kristian K Ullrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


