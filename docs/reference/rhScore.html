<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute the Hourglass Score for the Reductive Hourglass Test — rhScore • myTAI</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute the Hourglass Score for the Reductive Hourglass Test — rhScore"><meta property="og:description" content='This function reduces the destruction of an hourglass shaped pattern to a single score value.        
Based on a given TAI or TDI pattern the given vector is being
        divided into three developmental modules: early, mid, and late. The corrisponding TAI or TDI
        values in each developmental module are accumulated using the scoringMethod argument ("max-min" or "mean-mean").        
In more detail:                
(1) for a given TAI or TDI vector tai_profile or tdi_profile, we classify each value of tai_profile or tdi_profile into its corresponding developmental module early, mid, or late.        
(2) accumulate the tai_profile or tdi_profile values in each developmental module using the arithmetic mean (mean) in case scoringMethod = "mean-mean", or accumulate the tai_profile or tdi_profile values in each developmental module using max for the early and late module and min for the mid module in case scoringMethod = "max-min".        
(3) then reduce the three values for each developmental module by computing the difference between: early - mid, and late - mid.        
(4) the two difference values are referred to as a_early and a_late.        
Each developmental module now has an accumulated representation value which is being reduced to one value using the
        method argument ("max", "min", or "mean").        
                
Given the two accumulated values for each hourglass module: a_early and a_late,
        we reduce the two given values by:                

"max": \(S = max{a_early,a_late}\)
"min": \(S = min{a_early,a_late}\)
"mean": \(S = mean{a_early,a_late}\)
All together this results in a global score S.
This global score S is being returned by this function rhScore.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">myTAI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Advanced.html">Advanced Phylotranscriptomics Analyses</a>
    </li>
    <li>
      <a href="../articles/Enrichment.html">Enrichment Analyses</a>
    </li>
    <li>
      <a href="../articles/Expression.html">Gene Expression Analysis with `myTAI`</a>
    </li>
    <li>
      <a href="../articles/Intermediate.html">Intermediate Phylotranscriptomics Analyses</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction to the myTAI package</a>
    </li>
    <li>
      <a href="../articles/Phylostratigraphy.html">Discussing Genomic Phylostratigraphy</a>
    </li>
    <li>
      <a href="../articles/Taxonomy.html">Retrieving Taxonomic Information</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/drostlab/myTAI/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute the Hourglass Score for the Reductive Hourglass Test</h1>
    <small class="dont-index">Source: <a href="https://github.com/drostlab/myTAI/blob/HEAD/R/rhScore.R" class="external-link"><code>R/rhScore.R</code></a></small>
    <div class="hidden name"><code>rhScore.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function reduces the destruction of an hourglass shaped pattern to a single score value.</p>        
<p>Based on a given <code><a href="TAI.html">TAI</a></code> or <code><a href="TDI.html">TDI</a></code> pattern the given vector is being
        divided into three developmental modules: early, mid, and late. The corrisponding <code><a href="TAI.html">TAI</a></code> or <code><a href="TDI.html">TDI</a></code>
        values in each developmental module are accumulated using the <em>scoringMethod</em> argument ("max-min" or "mean-mean").</p>        
<p>In more detail:</p>                
<p>(1) for a given <code><a href="TAI.html">TAI</a></code> or <code><a href="TDI.html">TDI</a></code> vector <em>tai_profile</em> or <em>tdi_profile</em>, we classify each value of <em>tai_profile</em> or <em>tdi_profile</em> into its corresponding developmental module early, mid, or late.</p>        
<p>(2) accumulate the <em>tai_profile</em> or <em>tdi_profile</em> values in each developmental module using the arithmetic mean (<code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></code>) in case scoringMethod = "mean-mean", or accumulate the <em>tai_profile</em> or <em>tdi_profile</em> values in each developmental module using <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></code> for the early and late module and <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></code> for the mid module in case scoringMethod = "max-min".</p>        
<p>(3) then reduce the three values for each developmental module by computing the difference between: early - mid, and late - mid.</p>        
<p>(4) the two difference values are referred to as a_early and a_late.</p>        
<p>Each developmental module now has an accumulated representation value which is being reduced to one value using the
        <em>method</em> argument ("max", "min", or "mean").</p>        
                
<p>Given the two accumulated values for each hourglass module: a_early and a_late,
        we reduce the two given values by:</p>                
<ul><li><p><em>"max"</em>: \(S = max{a_early,a_late}\)</p></li>
<li><p><em>"min"</em>: \(S = min{a_early,a_late}\)</p></li>
<li><p><em>"mean"</em>: \(S = mean{a_early,a_late}\)</p></li>
</ul><p>All together this results in a global score <em>S</em>.
This global score <em>S</em> is being returned by this function <code>rhScore</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rhScore</span><span class="op">(</span></span>
<span>  <span class="va">age_vals</span>,</span>
<span>  <span class="va">early</span>,</span>
<span>  <span class="va">mid</span>,</span>
<span>  <span class="va">late</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  <span class="va">scoringMethod</span>,</span>
<span>  profile.warn <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>age_vals</dt>
<dd><p>a numeric vector containing <code><a href="TAI.html">TAI</a></code> or <code><a href="TDI.html">TDI</a></code> values for each developmental stage s.</p></dd>


<dt>early</dt>
<dd><p>a numeric vector including the numeric stage values that correspond to the early phase of development.</p></dd>


<dt>mid</dt>
<dd><p>a numeric vector including the numeric stage values that correspond to the middle phase of development.</p></dd>


<dt>late</dt>
<dd><p>a numeric vector including the numeric stage values that correspond to the late phase of development.</p></dd>


<dt>method</dt>
<dd><p>to determine the two value reduction value, resulting in the global score S: "max", or "min", or "mean".</p></dd>


<dt>scoringMethod</dt>
<dd><p>method to determine the module accumulation value: "max-min" or "mean-mean".</p></dd>


<dt>profile.warn</dt>
<dd><p>a bolean value indicating whether a warning is printed when the high-low-high pattern isn't followed.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a numeric value representing the hourglass destruction score.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The gpScore is a heuristic score enabling to  construct a test statistic to determine  
the significance of a present (phylotranscriptomic) hourglass pattern.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Drost HG et al. (2015) Mol Biol Evol. 32 (5): 1221-1231 doi:10.1093/molbev/msv012</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ReductiveHourglassTest.html">ReductiveHourglassTest</a></code>, <code><a href="TAI.html">TAI</a></code>, <code><a href="TDI.html">TDI</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Hajk-Georg Drost</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># read standard phylotranscriptomics data</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PhyloExpressionSetExample</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DivergenceExpressionSetExample</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># example PhyloExpressionSet:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># compute the TAI profile</span></span></span>
<span class="r-in"><span> <span class="va">TAIs</span> <span class="op">&lt;-</span> <span class="fu"><a href="TAI.html">TAI</a></span><span class="op">(</span><span class="va">PhyloExpressionSetExample</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># compute the global hourglass destruction score </span></span></span>
<span class="r-in"><span> <span class="co"># for the TAIs profile using reduction method: mean(mean-mean)</span></span></span>
<span class="r-in"><span> <span class="va">rh_score</span> <span class="op">&lt;-</span> <span class="fu">rhScore</span><span class="op">(</span>age_vals <span class="op">=</span> <span class="va">TAIs</span>,early <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,mid <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>,late <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">7</span>,</span></span>
<span class="r-in"><span>                     method <span class="op">=</span> <span class="st">"mean"</span>,scoringMethod <span class="op">=</span> <span class="st">"mean-mean"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># example DivergenceExpressionSet:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># compute the TDI profile</span></span></span>
<span class="r-in"><span> <span class="va">TDIs</span> <span class="op">&lt;-</span> <span class="fu"><a href="TDI.html">TDI</a></span><span class="op">(</span><span class="va">DivergenceExpressionSetExample</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># compute the global hourglass destruction score for the TDIs profile </span></span></span>
<span class="r-in"><span> <span class="co"># using reduction method: mean(mean-mean)</span></span></span>
<span class="r-in"><span> <span class="va">rh_score</span> <span class="op">&lt;-</span> <span class="fu">rhScore</span><span class="op">(</span>age_vals <span class="op">=</span> <span class="va">TDIs</span>,early <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,mid <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>,late <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">7</span>,</span></span>
<span class="r-in"><span>                     method <span class="op">=</span> <span class="st">"mean"</span>,scoringMethod <span class="op">=</span> <span class="st">"mean-mean"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                     </span></span>
<span class="r-in"><span> <span class="co"># get warning if the expected pattern isn't followed</span></span></span>
<span class="r-in"><span> <span class="va">rh_score</span> <span class="op">&lt;-</span> <span class="fu">rhScore</span><span class="op">(</span>age_vals <span class="op">=</span> <span class="va">TAIs</span>,early <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,mid <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>,late <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">7</span>,</span></span>
<span class="r-in"><span>                     method <span class="op">=</span> <span class="st">"mean"</span>,scoringMethod <span class="op">=</span> <span class="st">"mean-mean"</span>,profile.warn<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Hajk-Georg Drost, Kristian K Ullrich.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

